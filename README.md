# PQT Authentication Protocol

基于后量子密码学的身份认证协议设计与实现

## 项目概述

本项目实现了一个基于后量子密码学（Post-Quantum Cryptography, PQC）的身份认证协议，结合了传统的SM9身份认证算法和后量子密码学算法，为量子计算时代的网络安全提供保障。

## 技术架构

### 核心组件

#### 1. 主机端（Host）

- **主要功能**: 网络通信、协议协调、用户交互
- **核心文件**: 
  - `main.c`: 主程序入口，实现节点功能选择菜单
  - `socket_zmq.c/h`: 基于ZeroMQ的网络通信实现
  - `socket_handle.c/h`: 协议消息处理和数据包封装
  - `cafun.c/h`: 核心认证功能实现
  - `selfqueue.c/h`: 自管理队列实现

#### 2. 可信执行环境（TEE）

- **TA1**: 身份认证模块，集成SM9算法和后量子签名算法
- **TA2**: 内容认证模块，实现后量子密钥封装机制

#### 3. 密码学库

- **talib1**: 传统密码学库，包含SM2、SM3、SM4、SM9等算法
- **talib2**: 后量子密钥封装库，基于Kyber算法
- **talib3**: 后量子签名库，基于Dilithium算法

## 核心算法

### 后量子密码学算法

#### Kyber (密钥封装机制)

- **Kyber512**: 2级安全强度，适用于一般应用
- **Kyber768**: 3级安全强度，适用于高安全需求
- **Kyber1024**: 4级安全强度，适用于最高安全需求

#### Dilithium (数字签名)

- **Dilithium2**: 2级安全强度
- **Dilithium3**: 3级安全强度  
- **Dilithium5**: 5级安全强度

### 传统密码学算法

- **SM9**: 基于双线性对的标识密码算法
- **SM2**: 椭圆曲线公钥密码算法
- **SM3**: 密码杂凑算法
- **SM4**: 分组密码算法

## 协议流程

### 1. 身份认证阶段

```
节点 → 中心节点: 申请公钥 (ppube)
中心节点 → 节点: 返回加密的身份密钥 (enkid)
节点 → 中心节点: 申请加密的公钥 (enpkey)
中心节点 → 节点: 返回加密的公钥 (enpkey)
```

### 2. 密钥协商阶段

```
节点A ↔ 节点B: 交换随机数R
节点A ↔ 节点B: 生成会话密钥S
节点A ↔ 节点B: 确认会话密钥
```

### 3. 内容认证阶段

```
节点A → 节点B: 发送数据包和HMAC
节点B: 验证HMAC并返回确认标志
```

## 网络架构

### 通信模式

- **中心节点**: 负责密钥分发和身份管理
- **普通节点**: 执行身份认证和密钥协商
- **通信协议**: 基于ZeroMQ的REQ-REP模式

### 网络配置

```c
char center_ipset[] = "tcp://192.168.128.150:5555";  // 中心节点
char node1_ipset[] = "tcp://192.168.0.150:5566";     // 节点1
char node2_ipset[] = "tcp://192.168.0.160:5566";     // 节点2
char node3_ipset[] = "tcp://192.168.0.153:5566";     // 节点3
```

## 编译与运行

### 环境要求

- Linux操作系统
- GCC编译器
- ZeroMQ库
- OpenTEE/OP-TEE环境
- liboqs库

### 编译步骤

#### 方法1: 使用Makefile

```bash
cd host
make clean
make
```

#### 方法2: 使用CMake

```bash
cd host
mkdir build && cd build
cmake ..
make
```

### 运行方式

```bash
./node1
```

## 功能菜单

程序启动后提供以下功能选择：

1. **pqc_kem**: 后量子密钥封装认证
2. **exchange_sk**: 身份认证交换会话密钥
3. **node_context**: 内容认证
4. **time_update**: 时间更新
5. **attack_test**: 攻击测试
6. **exchange_sk_wrong**: 错误RID测试
7. **exit**: 退出程序

## 安全特性

### 量子抗性

- 基于格密码学的后量子算法
- 抵抗Shor算法等量子攻击
- 支持多种安全强度级别

### 身份认证

- 基于SM9的双因子认证
- 时间戳和随机数双重保护
- 安全的密钥分发机制

### 通信安全

- 端到端加密通信
- 会话密钥动态生成
- 防重放攻击保护

## 项目结构

```
PQT authentication protocol/
├── host/                 # 主机端程序
│   ├── main.c           # 主程序
│   ├── socket_zmq.c/h   # 网络通信
│   ├── socket_handle.c/h # 协议处理
│   ├── cafun.c/h        # 核心功能
│   ├── selfqueue.c/h    # 队列管理
│   └── zeromq/          # ZeroMQ库
├── ta/                  # 可信应用1 (身份认证)
├── ta2/                 # 可信应用2 (内容认证)
├── talib1/              # 传统密码学库
├── talib2/              # 后量子密钥封装库
├── talib3/              # 后量子签名库
└── back/                # 后端服务
```

## 技术特点

1. **混合密码学**: 结合传统密码学和后量子密码学
2. **可信执行**: 基于TEE的安全计算环境
3. **模块化设计**: 清晰的层次结构和接口定义
4. **高性能**: 优化的算法实现和网络通信
5. **可扩展性**: 支持多种安全参数和算法变体

## 应用场景

- **物联网安全**: 设备身份认证和密钥管理
- **边缘计算**: 分布式节点的安全通信
- **区块链**: 后量子安全的数字签名
- **5G/6G网络**: 下一代通信网络安全
- **关键基础设施**: 高安全要求的系统保护

## 开发团队

本项目为毕业设计项目，专注于后量子密码学在身份认证领域的应用研究。

## 许可证

本项目采用BSD-2-Clause许可证。

## 联系方式

如有问题或建议，请联系项目维护者。

---

*本项目展示了后量子密码学在实际应用中的可行性，为未来量子计算时代的网络安全提供了重要参考。*****
